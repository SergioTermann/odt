<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="900" height="420" viewBox="0 0 900 420">
  <defs>
    <style>
      .title{font-family:Inter,Arial,Helvetica,sans-serif;font-size:22px;font-weight:700;fill:#142b3f}
      .label{font-family:Inter,Arial,Helvetica,sans-serif;font-size:14px;fill:#1e2f49}
      .dim{font-family:Inter,Arial,Helvetica,sans-serif;font-size:12px;fill:#415a77}
      .arrow{stroke:#0f1f33;stroke-width:2.2;fill:none}
    </style>
    <linearGradient id="gbox" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#f7faff"/>
      <stop offset="100%" stop-color="#e8f0ff"/>
    </linearGradient>
    <linearGradient id="gop" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#fff2e6"/>
      <stop offset="100%" stop-color="#ffe7cc"/>
    </linearGradient>
    <linearGradient id="gact" x1="0" y1="0" x2="0" y2="1">
      <stop offset="0%" stop-color="#eaf8ef"/>
      <stop offset="100%" stop-color="#dbf2e3"/>
    </linearGradient>
    <filter id="ds" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#000000" flood-opacity="0.15"/>
    </filter>
    <marker id="arrowhead" markerWidth="12" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L12,4 L0,8 Z" fill="#0f1f33"/>
    </marker>
  </defs>

  <!-- Title -->
  <text x="450" y="34" text-anchor="middle" class="title">ExplanationGenerator (Sequential)</text>

  <!-- Input -->
  <rect x="50" y="90" width="150" height="70" rx="12" ry="12" fill="url(#gbox)" stroke="#5b7db0" stroke-width="2" filter="url(#ds)"/>
  <text x="125" y="115" text-anchor="middle" class="label">Input x</text>
  <text x="125" y="135" text-anchor="middle" class="dim">x ∈ ℝ^{3·hidden_size}</text>

  <!-- Linear 1 -->
  <path d="M200,125 C215,125 225,125 235,125" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="235" y="88" width="165" height="74" rx="12" ry="12" fill="url(#gop)" stroke="#c47f3a" stroke-width="2" filter="url(#ds)"/>
  <text x="317" y="113" text-anchor="middle" class="label">Linear</text>
  <text x="317" y="133" text-anchor="middle" class="dim">3h → 2h</text>

  <!-- ReLU 1 -->
  <path d="M400,125 C415,125 425,125 435,125" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="435" y="96" width="95" height="58" rx="12" ry="12" fill="url(#gact)" stroke="#4a9c5b" stroke-width="2" filter="url(#ds)"/>
  <text x="482" y="125" text-anchor="middle" class="label">ReLU</text>

  <!-- Linear 2 -->
  <path d="M530,125 C545,125 555,125 565,125" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="565" y="88" width="165" height="74" rx="12" ry="12" fill="url(#gop)" stroke="#c47f3a" stroke-width="2" filter="url(#ds)"/>
  <text x="647" y="113" text-anchor="middle" class="label">Linear</text>
  <text x="647" y="133" text-anchor="middle" class="dim">2h → h</text>

  <!-- ReLU 2 -->
  <path d="M730,125 C745,125 755,125 765,125" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="765" y="96" width="95" height="58" rx="12" ry="12" fill="url(#gact)" stroke="#4a9c5b" stroke-width="2" filter="url(#ds)"/>
  <text x="812" y="125" text-anchor="middle" class="label">ReLU</text>

  <!-- Linear 3 -->
  <path d="M860,125 C875,125 885,125 895,125" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="895" y="88" width="165" height="74" rx="12" ry="12" fill="url(#gop)" stroke="#c47f3a" stroke-width="2" filter="url(#ds)"/>
  <text x="977" y="113" text-anchor="middle" class="label">Linear</text>
  <text x="977" y="133" text-anchor="middle" class="dim">h → 2K</text>

  <!-- Output -->
  <path d="M977,162 C977,175 977,185 977,198" class="arrow" marker-end="url(#arrowhead)"/>
  <rect x="895" y="198" width="165" height="74" rx="12" ry="12" fill="url(#gbox)" stroke="#5b7db0" stroke-width="2" filter="url(#ds)"/>
  <text x="977" y="223" text-anchor="middle" class="label">Output y</text>
  <text x="977" y="243" text-anchor="middle" class="dim">y ∈ ℝ^{2K}</text>

  <!-- Subtle baseline -->
  <line x1="50" y1="290" x2="1060" y2="290" stroke="#e2e8f0" stroke-width="2" stroke-dasharray="6 6"/>

  <!-- Notes -->
  <text x="450" y="340" text-anchor="middle" class="dim">h = hidden_size, K = #tasks; pipeline: x → Linear → ReLU → Linear → ReLU → Linear → y</text>
</svg>